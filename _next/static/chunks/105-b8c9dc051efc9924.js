"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[105],{2381:function(e,r,o){o.d(r,{d:function(){return c},z:function(){return d}});var t=o(7437),a=o(2265),n=o(7053),s=o(535),i=o(3448);let c=(0,s.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),d=a.forwardRef((e,r)=>{let{className:o,variant:a,size:s,asChild:d=!1,...l}=e,u=d?n.g7:"button";return(0,t.jsx)(u,{className:(0,i.cn)(c({variant:a,size:s,className:o})),ref:r,...l})});d.displayName="Button"},4463:function(e,r,o){o.d(r,{G:function(){return u},j:function(){return l}});var t=o(7437),a=o(2265),n=o(4438),s=o(5369);let i=(0,a.createContext)(void 0),c=(e,r)=>{try{return localStorage.setItem(e,r),!0}catch(r){return console.error("Erro ao salvar ".concat(e," no localStorage:"),r),!1}},d=e=>{try{return localStorage.getItem(e)}catch(r){return console.error("Erro ao ler ".concat(e," do localStorage:"),r),null}};function l(e){let{children:r}=e,[o,l]=(0,a.useState)([]),[u,p]=(0,a.useState)(""),[m,g]=(0,a.useState)({darkness:8,width:840,height:176,speed:2,port:"Windows"}),[f,v]=(0,a.useState)(!1),[_,h]=(0,a.useState)(!1),S=(e,r)=>{l(e),r&&e.includes(r)?(console.log("Usando impressora salva:",r),p(r)):!u&&e.length>0&&(console.log("Selecionando primeira impressora dispon\xedvel:",e[0]),p(e[0])),c("cachedPrinters",JSON.stringify(e)),c("printersCacheTime",Date.now().toString())},w=async e=>{console.log("Definindo impressora selecionada:",e),p(e),c("selectedPrinter",e);try{let r={...m,port:"Windows",selected_printer:e};return console.log("Salvando configura\xe7\xe3o com impressora:",r),await (0,s.L)("save_printer_settings",{config:r}),(0,s.U)()&&await (0,s.L)("connect_printer",{config:r,printerName:e}),console.log("Impressora salva e conectada com sucesso:",e),!0}catch(e){return console.error("Erro ao salvar impressora nas configura\xe7\xf5es:",e),!1}},y=async function(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0];arguments.length>1&&void 0!==arguments[1]&&arguments[1],v(!0);let r=d("cachedPrinters"),o=d("printersCacheTime"),t=o?Date.now()-Number.parseInt(o):Number.POSITIVE_INFINITY;if(r&&t<3e5)try{let o=JSON.parse(r);if(Array.isArray(o)&&o.length>0&&(S(o,m.selected_printer||d("selectedPrinter")),t<3e4&&!e)){v(!1);return}}catch(e){console.error("Erro ao processar cache de impressoras:",e)}try{let r=await (0,s.L)("list_printers",{silent:!0});S(r,m.selected_printer||d("selectedPrinter")),0===r.length?e&&n.Am.error("Nenhuma impressora encontrada no Windows",{description:(0,s.U)()?"Instale uma impressora no Windows para continuar.":"No modo web, usamos impressoras simuladas."}):e&&n.Am.success("Impressoras encontradas!",{description:"".concat(r.length," impressora(s) dispon\xedvel(is)")})}catch(r){console.error("Erro ao procurar impressoras:",r),e&&n.Am.error("Erro ao procurar impressoras",{description:String(r)})}finally{v(!1)}},b=async()=>{try{console.log("Carregando configura\xe7\xf5es salvas...");let e=await (0,s.L)("get_printer_settings");if(e){if(console.log("Configura\xe7\xf5es carregadas:",e),g(e),e.selected_printer)console.log("Impressora salva encontrada nas configura\xe7\xf5es:",e.selected_printer),p(e.selected_printer),c("selectedPrinter",e.selected_printer);else{console.log("Nenhuma impressora salva nas configura\xe7\xf5es");let r=d("selectedPrinter");if(r){console.log("Impressora encontrada no localStorage:",r),p(r);let o={...e,selected_printer:r};g(o),await (0,s.L)("save_printer_settings",{config:o}),console.log("Configura\xe7\xf5es atualizadas com impressora do localStorage")}}}else{console.log("Nenhuma configura\xe7\xe3o salva encontrada");let e=d("selectedPrinter");if(e){console.log("Impressora encontrada no localStorage:",e),p(e);let r={...m,selected_printer:e};g(r),await (0,s.L)("save_printer_settings",{config:r}),console.log("Novas configura\xe7\xf5es criadas com impressora do localStorage")}}}catch(r){console.error("Erro ao carregar configura\xe7\xf5es:",r);let e=d("selectedPrinter");e&&(console.log("Usando impressora do localStorage ap\xf3s erro:",e),p(e))}},P=async()=>{if(!u){n.Am.error("Nenhuma impressora selecionada",{description:"Selecione uma impressora primeiro"});return}v(!0);try{let e={...m,port:"Windows",selected_printer:u};console.log("Salvando configura\xe7\xf5es completas:",e),await (0,s.L)("save_printer_settings",{config:e}),(0,s.U)()&&await (0,s.L)("connect_printer",{config:e,printerName:u}),n.Am.success("Configura\xe7\xf5es salvas",{description:(0,s.U)()?"Impressora conectada e pronta para uso":"Configura\xe7\xf5es salvas (modo de demonstra\xe7\xe3o)"})}catch(e){console.error("Erro ao salvar configura\xe7\xf5es:",e),n.Am.error("Erro ao salvar configura\xe7\xf5es",{description:String(e)})}finally{v(!1)}},I=async()=>{if(!u){n.Am.error("Nenhuma impressora selecionada",{description:"Selecione uma impressora primeiro"});return}v(!0);try{(0,s.U)()?(await (0,s.L)("print_test",{printerName:u}),n.Am.success("Teste enviado com sucesso",{description:"Verifique a impressora para confirmar a impress\xe3o"})):(await new Promise(e=>setTimeout(e,1e3)),n.Am.success("Modo de demonstra\xe7\xe3o",{description:"Em uma instala\xe7\xe3o real, uma etiqueta de teste seria impressa"}))}catch(e){console.error("Erro ao enviar teste:",e),n.Am.error("Erro ao imprimir teste",{description:String(e)})}finally{v(!1)}},x=async()=>{if(!(0,s.U)())return!0;try{return await (0,s.L)("is_printer_connected")}catch(e){return console.error("Erro ao verificar conex\xe3o da impressora:",e),!1}};return(0,a.useEffect)(()=>{_||(async()=>{v(!0);try{await b(),await y(!1)}catch(e){console.error("Erro na inicializa\xe7\xe3o do contexto de impressora:",e)}finally{v(!1),h(!0)}})()},[_]),(0,t.jsx)(i.Provider,{value:{printers:o,selectedPrinter:u,config:m,loading:f,searchPrinters:y,setSelectedPrinter:w,saveConfig:P,testPrint:I,updateConfig:e=>{g(r=>({...r,...e}))},isPrinterConnected:x},children:r})}function u(){let e=(0,a.useContext)(i);if(void 0===e)throw Error("usePrinter must be used within a PrinterProvider");return e}},5369:function(e,r,o){o.d(r,{L:function(){return i},U:function(){return t}});let t=()=>window.__TAURI__,a=(e,r)=>{let o=localStorage.getItem(e);return o?JSON.parse(o):r},n=(e,r)=>{localStorage.setItem(e,JSON.stringify(r))},s=[{id:1,name:"Parafuso Sextavado",name_short:"PARF SEX",product_code:"P001",barcode:"7898465810019",description:"Parafuso sextavado 10mm"},{id:2,name:"Porca Sextavada",name_short:"PORC SEX",product_code:"P002",barcode:"7898465810026",description:"Porca sextavada 10mm"},{id:3,name:"Arruela Lisa",name_short:"ARR LISA",product_code:"A001",barcode:"7898465810033",description:"Arruela lisa 10mm"}];async function i(e,r){if(t()){let{invoke:t}=await o.e(712).then(o.bind(o,712));return await t(e,r)}switch(console.log("Web simulation: ".concat(e),r),await new Promise(e=>setTimeout(e,500)),e){case"get_products":return a("products",s);case"get_product":let i=a("products",s),c=null==r?void 0:r.id;return i.find(e=>e.id===c);case"create_product":let d=null==r?void 0:r.product,l=a("products",s);return d.id=Math.max(0,...l.map(e=>e.id||0))+1,d.created_at=new Date().toISOString(),n("products",[...l,d]),d;case"update_product":let u=null==r?void 0:r.product,p=null==r?void 0:r.id,m=a("products",s),g=m.findIndex(e=>e.id===p);if(g>=0)return m[g]={...u,updated_at:new Date().toISOString()},n("products",m),u;throw Error("Produto n\xe3o encontrado");case"delete_product":let f=null==r?void 0:r.id;return n("products",a("products",s).filter(e=>e.id!==f)),!0;case"get_printer_settings":return a("printer_settings",{darkness:8,width:840,height:176,speed:2,port:"Simulado",selected_printer:"Impressora Simulada"});case"save_printer_settings":return n("printer_settings",null==r?void 0:r.config),!0;case"print_label_batch":return!0;case"list_printers":return["Impressora Simulada 1","Impressora Simulada 2"];case"get_print_history":return a("print_history",[{id:1,product_id:1,product_name:"Parafuso Sextavado",product_code:"P001",created_at:new Date(Date.now()-864e5).toISOString(),status:"completed"},{id:2,product_id:2,product_name:"Porca Sextavada",product_code:"P002",created_at:new Date().toISOString(),status:"completed"}]);default:return console.warn("Comando n\xe3o implementado na vers\xe3o web: ".concat(e)),null}}},3448:function(e,r,o){o.d(r,{cn:function(){return n}});var t=o(1994),a=o(3335);function n(){for(var e=arguments.length,r=Array(e),o=0;o<e;o++)r[o]=arguments[o];return(0,a.m6)((0,t.W)(r))}}}]);