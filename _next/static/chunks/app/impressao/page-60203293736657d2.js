(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[464],{6555:function(e,r,t){Promise.resolve().then(t.bind(t,2773))},2252:function(e,r,t){"use strict";t.d(r,{Z:function(){return a}});let a=(0,t(9763).Z)("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},401:function(e,r,t){"use strict";t.d(r,{Z:function(){return a}});let a=(0,t(9763).Z)("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]])},7625:function(e,r,t){"use strict";t.d(r,{Z:function(){return a}});let a=(0,t(9763).Z)("Printer",[["polyline",{points:"6 9 6 2 18 2 18 9",key:"1306q4"}],["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["rect",{width:"12",height:"8",x:"6",y:"14",key:"5ipwut"}]])},2773:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return X}});var a=t(7437),s=t(2265),n=t(712),i=t(2381),o=t(9820),l=t(3804),c=t(9763);let d=(0,c.Z)("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);var u=t(2252),f=t(7625),m=t(3247),p=t(9397),x=t(279),g=t(8575),h=t(3966),v=t(6741),y=t(886),b=t(6718),j=t(420),N=t(1599),w=t(6840),k="Checkbox",[S,E]=(0,h.b)(k),[C,_]=S(k),z=s.forwardRef((e,r)=>{let{__scopeCheckbox:t,name:n,checked:i,defaultChecked:o,required:l,disabled:c,value:d="on",onCheckedChange:u,form:f,...m}=e,[p,x]=s.useState(null),h=(0,g.e)(r,e=>x(e)),b=s.useRef(!1),j=!p||f||!!p.closest("form"),[N=!1,k]=(0,y.T)({prop:i,defaultProp:o,onChange:u}),S=s.useRef(N);return s.useEffect(()=>{let e=null==p?void 0:p.form;if(e){let r=()=>k(S.current);return e.addEventListener("reset",r),()=>e.removeEventListener("reset",r)}},[p,k]),(0,a.jsxs)(C,{scope:t,state:N,disabled:c,children:[(0,a.jsx)(w.WV.button,{type:"button",role:"checkbox","aria-checked":A(N)?"mixed":N,"aria-required":l,"data-state":P(N),"data-disabled":c?"":void 0,disabled:c,value:d,...m,ref:h,onKeyDown:(0,v.M)(e.onKeyDown,e=>{"Enter"===e.key&&e.preventDefault()}),onClick:(0,v.M)(e.onClick,e=>{k(e=>!!A(e)||!e),j&&(b.current=e.isPropagationStopped(),b.current||e.stopPropagation())})}),j&&(0,a.jsx)(q,{control:p,bubbles:!b.current,name:n,value:d,checked:N,required:l,disabled:c,form:f,style:{transform:"translateX(-100%)"},defaultChecked:!A(o)&&o})]})});z.displayName=k;var R="CheckboxIndicator",I=s.forwardRef((e,r)=>{let{__scopeCheckbox:t,forceMount:s,...n}=e,i=_(R,t);return(0,a.jsx)(N.z,{present:s||A(i.state)||!0===i.state,children:(0,a.jsx)(w.WV.span,{"data-state":P(i.state),"data-disabled":i.disabled?"":void 0,...n,ref:r,style:{pointerEvents:"none",...e.style}})})});I.displayName=R;var q=e=>{let{control:r,checked:t,bubbles:n=!0,defaultChecked:i,...o}=e,l=s.useRef(null),c=(0,b.D)(t),d=(0,j.t)(r);s.useEffect(()=>{let e=l.current,r=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"checked").set;if(c!==t&&r){let a=new Event("click",{bubbles:n});e.indeterminate=A(t),r.call(e,!A(t)&&t),e.dispatchEvent(a)}},[c,t,n]);let u=s.useRef(!A(t)&&t);return(0,a.jsx)("input",{type:"checkbox","aria-hidden":!0,defaultChecked:null!=i?i:u.current,...o,tabIndex:-1,ref:l,style:{...e.style,...d,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function A(e){return"indeterminate"===e}function P(e){return A(e)?"indeterminate":e?"checked":"unchecked"}var T=t(401),Z=t(3448);let D=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)(z,{ref:r,className:(0,Z.cn)("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",t),...s,children:(0,a.jsx)(I,{className:(0,Z.cn)("flex items-center justify-center text-current"),children:(0,a.jsx)(T.Z,{className:"h-4 w-4"})})})});D.displayName=z.displayName;var V=t(4438);let O=(0,t(535).j)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),M=s.forwardRef((e,r)=>{let{className:t,variant:s,...n}=e;return(0,a.jsx)("div",{ref:r,role:"alert",className:(0,Z.cn)(O({variant:s}),t),...n})});M.displayName="Alert",s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("h5",{ref:r,className:(0,Z.cn)("mb-1 font-medium leading-none tracking-tight",t),...s})}).displayName="AlertTitle";let W=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("div",{ref:r,className:(0,Z.cn)("text-sm [&_p]:leading-relaxed",t),...s})});W.displayName="AlertDescription";var H=t(9174),F=t(4291);let B=(0,c.Z)("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),K=(0,c.Z)("ZoomIn",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]),L=(0,c.Z)("ZoomOut",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]);var Y=t(4463);function U(e){let{products:r,disabled:t=!1,onPrintSuccess:o}=e,[l,c]=(0,s.useState)(!1),[u,m]=(0,s.useState)(1),[p,x]=(0,s.useState)(!1),{selectedPrinter:g}=(0,Y.G)(),h=r.filter(e=>null!==e),v=new Set(h.map(e=>e.id)).size,y=h.length,b=e=>3.7795275591*e*u,j=e=>{let r=function(e){let r=[["0001101","0011001","0010011","0111101","0100011","0110001","0101111","0111011","0110111","0001011"],["0100111","0110011","0011011","0100001","0011101","0111001","0000101","0010001","0001001","0010111"]],t=["1110010","1100110","1101100","1000010","1011100","1001110","1010000","1000100","1001000","1110100"],a=e.slice(0,12).padStart(12,"0"),s=(10-a.slice(0,12).split("").map(Number).reduce((e,r,t)=>e+r*(t%2==0?1:3),0)%10)%10,n=a+s,i=Number.parseInt(n[0]),o="101";for(let e=1;e<=6;e++){let t=Number.parseInt(n[e]);o+=r[i&1<<5-(e-1)?1:0][t]}o+="01010";for(let e=7;e<=12;e++)o+=t[Number.parseInt(n[e])];return o+"101"}(e),t=b(22*.35),s=b(29.7),n=s/95,i=r.split("").map((e,r)=>{let s=r*n;return"1"===e?(0,a.jsx)("rect",{x:s,y:0,width:n,height:.8*t,fill:"black"},r):null});return(0,a.jsxs)("svg",{viewBox:"0 0 ".concat(s," ").concat(t),width:s,height:t,className:"max-w-full",children:[(0,a.jsx)("rect",{x:0,y:0,width:s,height:t,fill:"white"}),(0,a.jsx)("g",{children:i}),(0,a.jsx)("text",{x:s/2,y:1*t,textAnchor:"middle",fill:"black",fontSize:b(1.8),className:"font-mono",children:e})]})},N=async()=>{if(!g){V.A.error("Erro",{description:"Configure a impressora antes de imprimir."});return}x(!0);try{let e=0,r=h.length;for(let t=0;t<h.length;t+=3){let a=[...h.slice(t,t+3)];for(;a.length<3;)a.push(null);await (0,n.dw)("print_label_batch",{products:a,printerName:g}),e+=a.filter(e=>null!==e).length,V.A.info("Imprimindo...",{description:"Etiqueta ".concat(e," de ").concat(r)}),await new Promise(e=>setTimeout(e,1e3))}V.A.success("Sucesso",{description:"".concat(e," etiqueta(s) impressa(s) com sucesso!")}),c(!1),o&&o()}catch(e){console.error("Erro ao imprimir:",e),V.A.error("Erro de Impress\xe3o",{description:"Verifique se a impressora est\xe1 conectada e configurada corretamente."})}finally{x(!1)}};return(0,a.jsxs)(F.Vq,{open:l,onOpenChange:c,children:[(0,a.jsx)(F.hg,{asChild:!0,children:(0,a.jsxs)(i.z,{variant:"outline",disabled:t,children:[(0,a.jsx)(B,{className:"h-4 w-4 mr-2"}),"Visualizar Etiquetas"]})}),(0,a.jsxs)(F.cZ,{className:"max-w-4xl",children:[(0,a.jsxs)(F.fK,{className:"flex flex-col gap-4 pb-2",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between pr-8",children:[(0,a.jsx)(F.$N,{children:"Preview das Etiquetas"}),(0,a.jsx)("div",{className:"flex items-center gap-2 bg-muted p-2 rounded-lg",children:(0,a.jsx)(i.z,{variant:"ghost",size:"icon",onClick:()=>{m(e=>1===e?2:1)},title:1===u?"Aumentar zoom":"Visualizar em tamanho real",children:1===u?(0,a.jsx)(K,{className:"h-4 w-4"}):(0,a.jsx)(L,{className:"h-4 w-4"})})})]}),(0,a.jsxs)(F.Be,{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{children:"Visualiza\xe7\xe3o das etiquetas que ser\xe3o impressas"}),(0,a.jsx)("span",{className:"text-sm font-normal text-muted-foreground",children:1===u?"Tamanho Real":"Zoom 2x"})]})]}),(0,a.jsx)("div",{className:"rounded-lg transition-colors bg-slate-800",style:{maxHeight:"calc(90vh - 200px)",overflowY:"auto"},children:(0,a.jsx)("div",{className:"p-6",style:{padding:"".concat(1*u,"rem")},children:(0,a.jsx)("div",{className:"flex flex-col gap-4",children:(()=>{let e=[];for(let r=0;r<h.length;r+=3)e.push(h.slice(r,r+3));return e})().map((e,r)=>(0,a.jsx)("div",{className:"grid grid-cols-3 mx-auto",style:{gap:"".concat(.5*u,"rem"),maxWidth:"".concat(124.7244094503*u*3+.5*u*32,"px")},children:e.map((e,t)=>(0,a.jsxs)("div",{className:(0,Z.cn)("shadow-lg rounded-lg flex flex-col items-center justify-between transition-all duration-200","relative overflow-hidden","bg-white text-black"),style:{width:b(33),height:b(22),padding:b(.5)},children:[(0,a.jsxs)("div",{className:"flex-1 flex flex-col justify-start items-center gap-[0.15rem] w-full",children:[(0,a.jsx)("div",{className:"w-full text-center font-bold tracking-wide text-black",style:{fontSize:"".concat(.6*u,"rem")},children:"ESTRELA METAIS"}),(0,a.jsx)("div",{className:"w-full text-center font-medium text-black",style:{fontSize:"".concat(.6*u,"rem")},children:e.name_short}),(0,a.jsx)("div",{className:"w-full text-center font-medium text-black",style:{fontSize:"".concat(.6*u,"rem")},children:e.product_code})]}),(0,a.jsx)("div",{className:"mt-auto w-full flex justify-center",children:j(e.barcode)})]},"".concat(r,"-").concat(t)))},r))})})}),(0,a.jsxs)("div",{className:"text-center text-sm text-muted-foreground space-y-1",children:[(0,a.jsxs)("p",{children:["Produtos diferentes: ",v," | ","Total de etiquetas: ",y]}),(0,a.jsx)("p",{children:"Dimens\xf5es de cada etiqueta: 33mm x 22mm"})]}),(0,a.jsx)(F.cN,{className:"mt-6",children:(0,a.jsxs)("div",{className:"flex w-full justify-between items-center",children:[(0,a.jsx)("div",{className:"text-sm text-muted-foreground"}),(0,a.jsx)(i.z,{onClick:N,disabled:p||!g||0===h.length,className:"min-w-[150px]",children:p?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(d,{className:"h-4 w-4 mr-2 animate-spin"}),"Imprimindo..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(f.Z,{className:"h-4 w-4 mr-2"}),"Imprimir Etiquetas"]})})]})})]})]})}let G=(0,c.Z)("CheckSquare",[["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}],["path",{d:"M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11",key:"1jnkn4"}]]);function J(e){let r=e.replace(/\D/g,"");return r?parseInt(r,10).toString().padStart(3,"0"):""}function $(e){let r=parseInt(e,10);return r>=10&&r<=99?r.toString():e}function Q(e,r){if(!r.trim())return!0;let t=J(r);if(e===t)return!0;let a=$(e);return parseInt(r.replace(/\D/g,""),10)===parseInt(a,10)||e.includes(t)}function X(){let{selectedPrinter:e,config:r}=(0,Y.G)(),[t,c]=(0,s.useState)(null),[g,h]=(0,s.useState)(!1),v=(0,s.useRef)(null),y=(0,s.useRef)({}),[b,j]=(0,s.useState)([]),[N,w]=(0,s.useState)([]),[k,S]=(0,s.useState)(""),[E,C]=(0,s.useState)({}),[_,z]=(0,s.useState)(!1),[R,I]=(0,s.useState)(!0),[q,A]=(0,s.useState)([]),[P,T]=(0,s.useState)(new Map),[Z,O]=(0,s.useState)(!1),[F,B]=(0,s.useState)(0),[K,L]=(0,s.useState)(null),{uniqueProductsCount:X,totalEtiquetas:ee}={uniqueProductsCount:Object.keys(E).length,totalEtiquetas:Object.values(E).reduce((e,r)=>e+(""===r.quantity?0:Number(r.quantity)),0)},er=Object.keys(E).length>0,et=!!e,ea=(0,s.useCallback)(async()=>{try{let e=await (0,n.dw)("get_products");j(e),T(new Map(e.map(e=>[e.id,e])))}catch(e){console.error("Erro ao carregar produtos:",e),V.A.error("N\xe3o foi poss\xedvel carregar os produtos.",{description:String(e)})}},[]),es=(0,s.useCallback)(async()=>{try{let e=await (0,n.dw)("get_print_history");w(e)}catch(e){console.error("Erro ao carregar hist\xf3rico:",e)}},[]);(0,s.useEffect)(()=>{(async()=>{try{await Promise.all([ea(),es()])}catch(e){console.error("Erro ao inicializar p\xe1gina:",e)}finally{I(!1)}})()},[ea,es]),(0,s.useEffect)(()=>()=>{K&&clearTimeout(K)},[K]);let en=async()=>{if(!e){V.A.error("Erro",{description:"Configure a impressora antes de imprimir."});return}z(!0);try{let r=0,t=Object.values(E).reduce((e,r)=>{let t=""===r.quantity?0:Number(r.quantity);return e+t},0),a=[];for(let e in E){let r=E[e],t=""===r.quantity?1:Number(r.quantity);for(let e=0;e<t;e++)a.push(r)}for(let s=0;s<a.length;s+=3){let i=a.slice(s,s+3);for(;i.length<3;)i.push(null);await (0,n.dw)("print_label_batch",{products:i,printerName:e}),r+=i.filter(e=>null!==e).length,V.A.info("Imprimindo...",{description:"Etiqueta ".concat(r," de ").concat(t)}),await new Promise(e=>setTimeout(e,1e3))}V.A.success("Sucesso",{description:"".concat(r," etiqueta(s) impressa(s) com sucesso!")}),await es(),C({})}catch(e){console.error("Erro ao imprimir:",e),V.A.error("Erro de Impress\xe3o",{description:"Verifique se a impressora est\xe1 conectada e configurada corretamente."})}finally{z(!1)}},ei=e=>{C(r=>{let a={...r};return a[e.id]?(delete a[e.id],t===e.id&&(c(null),h(!1),setTimeout(()=>{v.current&&v.current.focus()},50))):a[e.id]={...e,quantity:1},a})},eo=(e,r)=>{let t=""===r?"":Number(r);C(r=>({...r,[e]:{...r[e],quantity:t}}))},el=(e,r)=>{if("Enter"===e.key){let e=E[r].quantity;(""===e||1>Number(e))&&eo(r,1),h(!1),c(null),v.current&&v.current.focus()}},ec=[...b.filter(e=>{if(g&&null!==t)return e.id===t;let r=!!E[e.id];if(k.trim()){let t=Q(e.product_code,k);return r||t}return r})].sort((e,r)=>{let t=!!E[e.id],a=!!E[r.id];if(k.trim()){let t=J(k),a=e.product_code===t,s=r.product_code===t;if(a&&!s)return -1;if(!a&&s)return 1;if(a===s){let t=Q(e.product_code,k),a=Q(r.product_code,k);if(t&&!a)return -1;if(!t&&a)return 1}}return t&&!a?-1:!t&&a?1:0});return R?(0,a.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,a.jsxs)("div",{className:"flex flex-col items-center gap-2",children:[(0,a.jsx)(d,{className:"h-8 w-8 animate-spin"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Carregando..."})]})}):(0,a.jsx)("div",{className:"container mx-auto p-4",children:(0,a.jsxs)("div",{className:"flex flex-col gap-6 max-w-full",children:[!et&&(0,a.jsxs)(M,{variant:"default",children:[(0,a.jsx)(u.Z,{className:"h-4 w-4"}),(0,a.jsxs)(W,{className:"flex items-center gap-2",children:["Impressora n\xe3o configurada.",(0,a.jsx)(i.z,{variant:"link",className:"px-2 py-0 h-auto",onClick:()=>window.location.href="/configuracao",children:"Configurar agora"})]})]}),(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold",children:"Impress\xe3o das Etiquetas"}),er&&(0,a.jsxs)(H.C,{variant:"secondary",children:[X," produto",X>1?"s":""," selecionado",X>1?"s":"",", ",ee," etiqueta",ee>1?"s":""]})]}),(0,a.jsxs)("div",{className:"flex gap-2 w-full sm:w-auto",children:[er&&(0,a.jsx)(U,{products:(()=>{let e=[];for(let r in E){let t=E[r],a=""===t.quantity?1:Number(t.quantity);for(let r=0;r<a;r++)e.push(t)}return e})(),disabled:!1}),(0,a.jsx)(i.z,{onClick:en,className:"transition-opacity duration-300",disabled:!er||_||!et,children:_?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(d,{className:"h-4 w-4 mr-2 animate-spin"}),"Imprimindo..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(f.Z,{className:"h-4 w-4 mr-2"}),"Imprimir Selecionados"]})})]})]}),(0,a.jsxs)("div",{className:"relative flex-1",children:[(0,a.jsx)(m.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-muted-foreground"}),(0,a.jsx)(x.I,{ref:v,placeholder:er?"Digite o c\xf3digo do produto para buscar ou aperte Enter DUAS VEZES para imprimir selecionados":"Digite o c\xf3digo do produto para buscar e aperte Enter para selecionar.",className:"pl-8 focus:ring-2 focus:ring-amber-400  focus-visible:ring-amber-400 focus-visible:ring-2",value:k,onChange:e=>S(e.target.value),onKeyDown:e=>{if("Enter"===e.key){if(!k.trim()&&er){K&&clearTimeout(K);let e=F+1;if(B(e),1===e){V.A.info("Pressione Enter novamente para imprimir",{description:"Pressione Enter mais uma vez para confirmar a impress\xe3o",duration:2e3});let e=setTimeout(()=>{B(0),L(null)},2e3);L(e)}else e>=2&&(B(0),L(null),K&&clearTimeout(K),en());return}if(k.trim()&&(B(0),K&&(clearTimeout(K),L(null))),k.trim()){var r,t;let e=J(k),a=b.find(r=>r.product_code===e);if(a){let e=a.id;E[e]||ei(a),eo(e,(null===(r=E[e])||void 0===r?void 0:r.quantity)||1),c(e),S(""),h(!0),setTimeout(()=>{y.current[e]&&(y.current[e].focus(),y.current[e].select())},50)}else{let e=b.find(e=>Q(e.product_code,k));if(e){let r=e.id;E[r]||ei(e),eo(r,(null===(t=E[r])||void 0===t?void 0:t.quantity)||1),c(r),S(""),h(!0),setTimeout(()=>{y.current[r]&&(y.current[r].focus(),y.current[r].select())},50)}else{let e=k.replace(/\D/g,"")?$(J(k)):k;V.A.error("Produto n\xe3o encontrado",{description:'Nenhum produto com o c\xf3digo "'.concat(e,'" foi encontrado.')})}}}}},autoFocus:!0})]}),(0,a.jsxs)(o.Zb,{children:[(0,a.jsx)(o.Ol,{children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)(o.ll,{children:"Produtos Selecionados"}),er&&(0,a.jsxs)(i.z,{variant:"ghost",size:"sm",onClick:()=>C({}),className:"h-7 px-2 flex items-center gap-2 border border-input hover:border-accent rounded-md transition-colors",children:[(0,a.jsx)(G,{className:"h-4 w-4"}),"Remover Todos"]})]})}),(0,a.jsx)(o.aY,{className:"max-h-[480px] overflow-y-auto",children:(0,a.jsxs)(l.iA,{children:[(0,a.jsx)(l.xD,{children:(0,a.jsxs)(l.SC,{children:[(0,a.jsx)(l.ss,{className:"w-[50px]"}),(0,a.jsx)(l.ss,{children:"C\xf3digo do Produto"}),(0,a.jsx)(l.ss,{children:"Codigo de Barras"}),(0,a.jsx)(l.ss,{children:"Nome"}),(0,a.jsx)(l.ss,{children:"Quantidade de Etiquetas"}),(0,a.jsx)(l.ss,{className:"text-right",children:"Remover"})]})}),(0,a.jsx)(l.RM,{children:0===ec.length?(0,a.jsx)(l.SC,{children:(0,a.jsx)(l.pj,{colSpan:6,className:"text-center text-muted-foreground",children:k?"Ap\xf3s digitar o c\xf3digo do produto, presione Enter ":"Nenhum produto selecionado. Use o campo de busca para adicionar produtos."})}):ec.map(e=>(0,a.jsxs)(l.SC,{className:"\n                        ".concat(E[e.id]?"bg-primary/10 hover:bg-primary/15":"","\n                        table-row-enter table-row-enter-active table-row-move\n                      "),children:[(0,a.jsx)(l.pj,{children:(0,a.jsx)(D,{checked:!!E[e.id],onCheckedChange:()=>ei(e)})}),(0,a.jsx)(l.pj,{children:(0,a.jsx)("span",{className:"font-mono",children:$(e.product_code)})}),(0,a.jsx)(l.pj,{children:e.barcode}),(0,a.jsx)(l.pj,{children:e.name}),(0,a.jsx)(l.pj,{children:E[e.id]&&(0,a.jsx)(x.I,{type:"number",min:"0",value:E[e.id].quantity,onChange:r=>eo(e.id,r.target.value),className:"w-20 ".concat(t===e.id?"ring-2 ring-primary":""," focus:ring-2 focus:ring-amber-400  focus-visible:ring-amber-400"),ref:r=>{r&&(y.current[e.id]=r)},onKeyDown:r=>el(r,e.id)})}),(0,a.jsx)(l.pj,{className:"text-right",children:(0,a.jsx)(i.z,{variant:"outline",size:"icon",onClick:()=>ei(e),children:(0,a.jsx)(p.Z,{className:"h-4 w-4 rotate-45"})})})]},e.id))})]})})]})]})})}},9174:function(e,r,t){"use strict";t.d(r,{C:function(){return o}});var a=t(7437);t(2265);var s=t(535),n=t(3448);let i=(0,s.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function o(e){let{className:r,variant:t,...s}=e;return(0,a.jsx)("div",{className:(0,n.cn)(i({variant:t}),r),...s})}},2381:function(e,r,t){"use strict";t.d(r,{d:function(){return l},z:function(){return c}});var a=t(7437),s=t(2265),n=t(7053),i=t(535),o=t(3448);let l=(0,i.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),c=s.forwardRef((e,r)=>{let{className:t,variant:s,size:i,asChild:c=!1,...d}=e,u=c?n.g7:"button";return(0,a.jsx)(u,{className:(0,o.cn)(l({variant:s,size:i,className:t})),ref:r,...d})});c.displayName="Button"},9820:function(e,r,t){"use strict";t.d(r,{Ol:function(){return o},SZ:function(){return c},Zb:function(){return i},aY:function(){return d},ll:function(){return l}});var a=t(7437),s=t(2265),n=t(3448);let i=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("div",{ref:r,className:(0,n.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",t),...s})});i.displayName="Card";let o=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("div",{ref:r,className:(0,n.cn)("flex flex-col space-y-1.5 p-6",t),...s})});o.displayName="CardHeader";let l=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("div",{ref:r,className:(0,n.cn)("text-2xl font-semibold leading-none tracking-tight",t),...s})});l.displayName="CardTitle";let c=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("div",{ref:r,className:(0,n.cn)("text-sm text-muted-foreground",t),...s})});c.displayName="CardDescription";let d=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("div",{ref:r,className:(0,n.cn)("p-6 pt-0",t),...s})});d.displayName="CardContent",s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("div",{ref:r,className:(0,n.cn)("flex items-center p-6 pt-0",t),...s})}).displayName="CardFooter"},4291:function(e,r,t){"use strict";t.d(r,{$N:function(){return x},Be:function(){return g},Vq:function(){return l},cN:function(){return p},cZ:function(){return f},fK:function(){return m},hg:function(){return c}});var a=t(7437),s=t(2265),n=t(6100),i=t(2489),o=t(3448);let l=n.fC,c=n.xz,d=n.h_;n.x8;let u=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)(n.aV,{ref:r,className:(0,o.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...s})});u.displayName=n.aV.displayName;let f=s.forwardRef((e,r)=>{let{className:t,children:s,...l}=e;return(0,a.jsxs)(d,{children:[(0,a.jsx)(u,{}),(0,a.jsxs)(n.VY,{ref:r,className:(0,o.cn)("fixed left-[50%] top-[50%] z-50 grid w-full translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg overflow-hidden",t),...l,children:[s,(0,a.jsxs)(n.x8,{className:"absolute right-4 top-2 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,a.jsx)(i.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});f.displayName=n.VY.displayName;let m=e=>{let{className:r,...t}=e;return(0,a.jsx)("div",{className:(0,o.cn)("flex flex-col space-y-1.5 text-center sm:text-left",r),...t})};m.displayName="DialogHeader";let p=e=>{let{className:r,...t}=e;return(0,a.jsx)("div",{className:(0,o.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",r),...t})};p.displayName="DialogFooter";let x=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)(n.Dx,{ref:r,className:(0,o.cn)("text-lg font-semibold leading-none tracking-tight",t),...s})});x.displayName=n.Dx.displayName;let g=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)(n.dk,{ref:r,className:(0,o.cn)("text-sm text-muted-foreground",t),...s})});g.displayName=n.dk.displayName},279:function(e,r,t){"use strict";t.d(r,{I:function(){return i}});var a=t(7437),s=t(2265),n=t(3448);let i=s.forwardRef((e,r)=>{let{className:t,type:s,...i}=e;return(0,a.jsx)("input",{type:s,className:(0,n.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),ref:r,...i})});i.displayName="Input"},3804:function(e,r,t){"use strict";t.d(r,{RM:function(){return l},SC:function(){return c},iA:function(){return i},pj:function(){return u},ss:function(){return d},xD:function(){return o}});var a=t(7437),s=t(2265),n=t(3448);let i=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("div",{className:"relative w-full overflow-auto",children:(0,a.jsx)("table",{ref:r,className:(0,n.cn)("w-full caption-bottom text-sm",t),...s})})});i.displayName="Table";let o=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("thead",{ref:r,className:(0,n.cn)("[&_tr]:border-b",t),...s})});o.displayName="TableHeader";let l=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("tbody",{ref:r,className:(0,n.cn)("[&_tr:last-child]:border-0",t),...s})});l.displayName="TableBody",s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("tfoot",{ref:r,className:(0,n.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",t),...s})}).displayName="TableFooter";let c=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("tr",{ref:r,className:(0,n.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",t),...s})});c.displayName="TableRow";let d=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("th",{ref:r,className:(0,n.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",t),...s})});d.displayName="TableHead";let u=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("td",{ref:r,className:(0,n.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",t),...s})});u.displayName="TableCell",s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("caption",{ref:r,className:(0,n.cn)("mt-4 text-sm text-muted-foreground",t),...s})}).displayName="TableCaption"},4463:function(e,r,t){"use strict";t.d(r,{G:function(){return u},PrinterProvider:function(){return d}});var a=t(7437),s=t(2265),n=t(712),i=t(4438);let o=(0,s.createContext)(void 0),l=(e,r)=>{try{return localStorage.setItem(e,r),!0}catch(r){return console.error("Erro ao salvar ".concat(e," no localStorage:"),r),!1}},c=e=>{try{return localStorage.getItem(e)}catch(r){return console.error("Erro ao ler ".concat(e," do localStorage:"),r),null}};function d(e){let{children:r}=e,[t,d]=(0,s.useState)([]),[u,f]=(0,s.useState)(""),[m,p]=(0,s.useState)({darkness:8,width:840,height:176,speed:2,port:"Windows"}),[x,g]=(0,s.useState)(!1),[h,v]=(0,s.useState)(!1),y=(e,r)=>{d(e),r&&e.includes(r)?(console.log("Usando impressora salva:",r),f(r)):!u&&e.length>0&&(console.log("Selecionando primeira impressora dispon\xedvel:",e[0]),f(e[0])),l("cachedPrinters",JSON.stringify(e)),l("printersCacheTime",Date.now().toString())},b=async e=>{console.log("Definindo impressora selecionada:",e),f(e),l("selectedPrinter",e);try{let r={...m,port:"Windows",selected_printer:e};return console.log("Salvando configura\xe7\xe3o com impressora:",r),await (0,n.dw)("save_printer_settings",{config:r}),await (0,n.dw)("connect_printer",{config:r,printerName:e}),console.log("Impressora salva e conectada com sucesso:",e),!0}catch(e){return console.error("Erro ao salvar impressora nas configura\xe7\xf5es:",e),!1}},j=async function(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0];arguments.length>1&&void 0!==arguments[1]&&arguments[1];let r=c("cachedPrinters"),t=c("printersCacheTime"),a=t?Date.now()-Number.parseInt(t):Number.POSITIVE_INFINITY;if(r&&a<3e5)try{let t=JSON.parse(r);if(Array.isArray(t)&&t.length>0&&(y(t,m.selected_printer||c("selectedPrinter")),a<3e4&&!e))return}catch(e){console.error("Erro ao processar cache de impressoras:",e)}try{let r=await (0,n.dw)("list_printers",{silent:!0});y(r,m.selected_printer||c("selectedPrinter")),0===r.length?e&&i.A.error("Nenhuma impressora encontrada no Windows",{description:"Instale uma impressora no Windows para continuar."}):e&&i.A.success("Impressoras encontradas!",{description:"".concat(r.length," impressora(s) dispon\xedvel(is)")})}catch(r){console.error("Erro ao procurar impressoras:",r),e&&i.A.error("Erro ao procurar impressoras",{description:String(r)})}},N=async()=>{try{console.log("Carregando configura\xe7\xf5es salvas...");let e=await (0,n.dw)("get_printer_settings");if(e){if(console.log("Configura\xe7\xf5es carregadas:",e),p(e),e.selected_printer)console.log("Impressora salva encontrada nas configura\xe7\xf5es:",e.selected_printer),f(e.selected_printer),l("selectedPrinter",e.selected_printer);else{console.log("Nenhuma impressora salva nas configura\xe7\xf5es");let r=c("selectedPrinter");if(r){console.log("Impressora encontrada no localStorage:",r),f(r);let t={...e,selected_printer:r};p(t),await (0,n.dw)("save_printer_settings",{config:t}),console.log("Configura\xe7\xf5es atualizadas com impressora do localStorage")}}}else{console.log("Nenhuma configura\xe7\xe3o salva encontrada");let e=c("selectedPrinter");if(e){console.log("Impressora encontrada no localStorage:",e),f(e);let r={...m,selected_printer:e};p(r),await (0,n.dw)("save_printer_settings",{config:r}),console.log("Novas configura\xe7\xf5es criadas com impressora do localStorage")}}}catch(r){console.error("Erro ao carregar configura\xe7\xf5es:",r);let e=c("selectedPrinter");e&&(console.log("Usando impressora do localStorage ap\xf3s erro:",e),f(e))}},w=async()=>{if(!u){i.A.error("Nenhuma impressora selecionada",{description:"Selecione uma impressora primeiro"});return}g(!0);try{let e={...m,port:"Windows",selected_printer:u};console.log("Salvando configura\xe7\xf5es completas:",e),await (0,n.dw)("save_printer_settings",{config:e}),await (0,n.dw)("connect_printer",{config:e,printerName:u}),l("selectedPrinter",u),i.A.success("Configura\xe7\xf5es salvas!",{description:"Par\xe2metros de impress\xe3o atualizados."})}catch(e){console.error("Erro ao salvar configura\xe7\xf5es:",e),i.A.error("Erro ao salvar configura\xe7\xf5es",{description:String(e)})}finally{g(!1)}},k=async()=>{if(!u){i.A.error("Nenhuma impressora selecionada",{description:"Selecione uma impressora primeiro"});return}try{await (0,n.dw)("print_test",{printerName:u}),i.A.success("Teste enviado!",{description:"Verifique a impressora"})}catch(e){i.A.error("Erro ao imprimir teste",{description:String(e)})}},S=async()=>{try{return await (0,n.dw)("is_printer_connected")}catch(e){return console.error("Erro ao verificar conex\xe3o da impressora:",e),!1}};return(0,s.useEffect)(()=>{h||(async()=>{g(!0);try{await N(),await j(!1,!0)}catch(e){console.error("Erro na inicializa\xe7\xe3o:",e)}finally{g(!1),v(!0)}})()},[h]),(0,a.jsx)(o.Provider,{value:{printers:t,selectedPrinter:u,config:m,loading:x,searchPrinters:j,setSelectedPrinter:b,saveConfig:w,testPrint:k,updateConfig:e=>{p(r=>({...r,...e}))},isPrinterConnected:S},children:r})}function u(){let e=(0,s.useContext)(o);if(void 0===e)throw Error("usePrinter must be used within a PrinterProvider");return e}},3448:function(e,r,t){"use strict";t.d(r,{cn:function(){return n}});var a=t(1994),s=t(3335);function n(){for(var e=arguments.length,r=Array(e),t=0;t<e;t++)r[t]=arguments[t];return(0,s.m6)((0,a.W)(r))}},6718:function(e,r,t){"use strict";t.d(r,{D:function(){return s}});var a=t(2265);function s(e){let r=a.useRef({value:e,previous:e});return a.useMemo(()=>(r.current.value!==e&&(r.current.previous=r.current.value,r.current.value=e),r.current.previous),[e])}},420:function(e,r,t){"use strict";t.d(r,{t:function(){return n}});var a=t(2265),s=t(1188);function n(e){let[r,t]=a.useState(void 0);return(0,s.b)(()=>{if(e){t({width:e.offsetWidth,height:e.offsetHeight});let r=new ResizeObserver(r=>{let a,s;if(!Array.isArray(r)||!r.length)return;let n=r[0];if("borderBoxSize"in n){let e=n.borderBoxSize,r=Array.isArray(e)?e[0]:e;a=r.inlineSize,s=r.blockSize}else a=e.offsetWidth,s=e.offsetHeight;t({width:a,height:s})});return r.observe(e,{box:"border-box"}),()=>r.unobserve(e)}t(void 0)},[e]),r}}},function(e){e.O(0,[583,598,515,359,971,117,744],function(){return e(e.s=6555)}),_N_E=e.O()}]);