(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[464],{6070:function(e,r,t){Promise.resolve().then(t.bind(t,2773))},2252:function(e,r,t){"use strict";t.d(r,{Z:function(){return s}});let s=(0,t(9763).Z)("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},401:function(e,r,t){"use strict";t.d(r,{Z:function(){return s}});let s=(0,t(9763).Z)("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]])},7625:function(e,r,t){"use strict";t.d(r,{Z:function(){return s}});let s=(0,t(9763).Z)("Printer",[["polyline",{points:"6 9 6 2 18 2 18 9",key:"1306q4"}],["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["rect",{width:"12",height:"8",x:"6",y:"14",key:"5ipwut"}]])},2773:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return U}});var s=t(7437),a=t(2265),n=t(712),i=t(2381),o=t(9820),l=t(3804),c=t(9763);let d=(0,c.Z)("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);var u=t(2252),f=t(7625),m=t(3247),p=t(9397),x=t(279),g=t(8575),h=t(3966),y=t(6741),v=t(886),b=t(6718),j=t(420),w=t(1599),N=t(6840),k="Checkbox",[S,C]=(0,h.b)(k),[_,E]=S(k),z=a.forwardRef((e,r)=>{let{__scopeCheckbox:t,name:n,checked:i,defaultChecked:o,required:l,disabled:c,value:d="on",onCheckedChange:u,form:f,...m}=e,[p,x]=a.useState(null),h=(0,g.e)(r,e=>x(e)),b=a.useRef(!1),j=!p||f||!!p.closest("form"),[w=!1,k]=(0,v.T)({prop:i,defaultProp:o,onChange:u}),S=a.useRef(w);return a.useEffect(()=>{let e=null==p?void 0:p.form;if(e){let r=()=>k(S.current);return e.addEventListener("reset",r),()=>e.removeEventListener("reset",r)}},[p,k]),(0,s.jsxs)(_,{scope:t,state:w,disabled:c,children:[(0,s.jsx)(N.WV.button,{type:"button",role:"checkbox","aria-checked":A(w)?"mixed":w,"aria-required":l,"data-state":P(w),"data-disabled":c?"":void 0,disabled:c,value:d,...m,ref:h,onKeyDown:(0,y.M)(e.onKeyDown,e=>{"Enter"===e.key&&e.preventDefault()}),onClick:(0,y.M)(e.onClick,e=>{k(e=>!!A(e)||!e),j&&(b.current=e.isPropagationStopped(),b.current||e.stopPropagation())})}),j&&(0,s.jsx)(I,{control:p,bubbles:!b.current,name:n,value:d,checked:w,required:l,disabled:c,form:f,style:{transform:"translateX(-100%)"},defaultChecked:!A(o)&&o})]})});z.displayName=k;var R="CheckboxIndicator",q=a.forwardRef((e,r)=>{let{__scopeCheckbox:t,forceMount:a,...n}=e,i=E(R,t);return(0,s.jsx)(w.z,{present:a||A(i.state)||!0===i.state,children:(0,s.jsx)(N.WV.span,{"data-state":P(i.state),"data-disabled":i.disabled?"":void 0,...n,ref:r,style:{pointerEvents:"none",...e.style}})})});q.displayName=R;var I=e=>{let{control:r,checked:t,bubbles:n=!0,defaultChecked:i,...o}=e,l=a.useRef(null),c=(0,b.D)(t),d=(0,j.t)(r);a.useEffect(()=>{let e=l.current,r=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"checked").set;if(c!==t&&r){let s=new Event("click",{bubbles:n});e.indeterminate=A(t),r.call(e,!A(t)&&t),e.dispatchEvent(s)}},[c,t,n]);let u=a.useRef(!A(t)&&t);return(0,s.jsx)("input",{type:"checkbox","aria-hidden":!0,defaultChecked:null!=i?i:u.current,...o,tabIndex:-1,ref:l,style:{...e.style,...d,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function A(e){return"indeterminate"===e}function P(e){return A(e)?"indeterminate":e?"checked":"unchecked"}var Z=t(401),T=t(3448);let D=a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,s.jsx)(z,{ref:r,className:(0,T.cn)("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",t),...a,children:(0,s.jsx)(q,{className:(0,T.cn)("flex items-center justify-center text-current"),children:(0,s.jsx)(Z.Z,{className:"h-4 w-4"})})})});D.displayName=z.displayName;var V=t(4438);let O=(0,t(535).j)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),M=a.forwardRef((e,r)=>{let{className:t,variant:a,...n}=e;return(0,s.jsx)("div",{ref:r,role:"alert",className:(0,T.cn)(O({variant:a}),t),...n})});M.displayName="Alert",a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,s.jsx)("h5",{ref:r,className:(0,T.cn)("mb-1 font-medium leading-none tracking-tight",t),...a})}).displayName="AlertTitle";let L=a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,s.jsx)("div",{ref:r,className:(0,T.cn)("text-sm [&_p]:leading-relaxed",t),...a})});L.displayName="AlertDescription";var W=t(9174),F=t(4291);let H=(0,c.Z)("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),B=(0,c.Z)("ZoomIn",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]),K=(0,c.Z)("ZoomOut",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]);var Y=t(4463);function G(e){let{products:r,disabled:t=!1,onPrintSuccess:o}=e,[l,c]=(0,a.useState)(!1),[u,m]=(0,a.useState)(1),[p,x]=(0,a.useState)(!1),{selectedPrinter:g}=(0,Y.G)(),h=r.filter(e=>null!==e),y=new Set(h.map(e=>e.id)).size,v=h.length,b=e=>3.7795275591*e*u,j=e=>{let r=function(e){let r=[["0001101","0011001","0010011","0111101","0100011","0110001","0101111","0111011","0110111","0001011"],["0100111","0110011","0011011","0100001","0011101","0111001","0000101","0010001","0001001","0010111"]],t=["1110010","1100110","1101100","1000010","1011100","1001110","1010000","1000100","1001000","1110100"],s=e.slice(0,12).padStart(12,"0"),a=(10-s.slice(0,12).split("").map(Number).reduce((e,r,t)=>e+r*(t%2==0?1:3),0)%10)%10,n=s+a,i=Number.parseInt(n[0]),o="101";for(let e=1;e<=6;e++){let t=Number.parseInt(n[e]);o+=r[i&1<<5-(e-1)?1:0][t]}o+="01010";for(let e=7;e<=12;e++)o+=t[Number.parseInt(n[e])];return o+"101"}(e),t=b(22*.35),a=b(29.7),n=a/95,i=r.split("").map((e,r)=>{let a=r*n;return"1"===e?(0,s.jsx)("rect",{x:a,y:0,width:n,height:.8*t,fill:"black"},r):null});return(0,s.jsxs)("svg",{viewBox:"0 0 ".concat(a," ").concat(t),width:a,height:t,className:"max-w-full",children:[(0,s.jsx)("rect",{x:0,y:0,width:a,height:t,fill:"white"}),(0,s.jsx)("g",{children:i}),(0,s.jsx)("text",{x:a/2,y:1*t,textAnchor:"middle",fill:"black",fontSize:b(1.8),className:"font-mono",children:e})]})},w=async()=>{if(!g){V.A.error("Erro",{description:"Configure a impressora antes de imprimir."});return}x(!0);try{let e=0,r=h.length;for(let t=0;t<h.length;t+=3){let s=[...h.slice(t,t+3)];for(;s.length<3;)s.push(null);await (0,n.dw)("print_label_batch",{products:s,printerName:g}),e+=s.filter(e=>null!==e).length,V.A.info("Imprimindo...",{description:"Etiqueta ".concat(e," de ").concat(r)}),await new Promise(e=>setTimeout(e,1e3))}V.A.success("Sucesso",{description:"".concat(e," etiqueta(s) impressa(s) com sucesso!")}),c(!1),o&&o()}catch(e){console.error("Erro ao imprimir:",e),V.A.error("Erro de Impress\xe3o",{description:"Verifique se a impressora est\xe1 conectada e configurada corretamente."})}finally{x(!1)}};return(0,s.jsxs)(F.Vq,{open:l,onOpenChange:c,children:[(0,s.jsx)(F.hg,{asChild:!0,children:(0,s.jsxs)(i.z,{variant:"outline",disabled:t,children:[(0,s.jsx)(H,{className:"h-4 w-4 mr-2"}),"Visualizar Etiquetas"]})}),(0,s.jsxs)(F.cZ,{className:"max-w-4xl",children:[(0,s.jsxs)(F.fK,{className:"flex flex-col gap-4 pb-2",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between pr-8",children:[(0,s.jsx)(F.$N,{children:"Preview das Etiquetas"}),(0,s.jsx)("div",{className:"flex items-center gap-2 bg-muted p-2 rounded-lg",children:(0,s.jsx)(i.z,{variant:"ghost",size:"icon",onClick:()=>{m(e=>1===e?2:1)},title:1===u?"Aumentar zoom":"Visualizar em tamanho real",children:1===u?(0,s.jsx)(B,{className:"h-4 w-4"}):(0,s.jsx)(K,{className:"h-4 w-4"})})})]}),(0,s.jsxs)(F.Be,{className:"flex items-center justify-between",children:[(0,s.jsx)("span",{children:"Visualiza\xe7\xe3o das etiquetas que ser\xe3o impressas"}),(0,s.jsx)("span",{className:"text-sm font-normal text-muted-foreground",children:1===u?"Tamanho Real":"Zoom 2x"})]})]}),(0,s.jsx)("div",{className:"rounded-lg transition-colors bg-slate-800",style:{maxHeight:"calc(90vh - 200px)",overflowY:"auto"},children:(0,s.jsx)("div",{className:"p-6",style:{padding:"".concat(1*u,"rem")},children:(0,s.jsx)("div",{className:"flex flex-col gap-4",children:(()=>{let e=[];for(let r=0;r<h.length;r+=3)e.push(h.slice(r,r+3));return e})().map((e,r)=>(0,s.jsx)("div",{className:"grid grid-cols-3 mx-auto",style:{gap:"".concat(.5*u,"rem"),maxWidth:"".concat(124.7244094503*u*3+.5*u*32,"px")},children:e.map((e,t)=>(0,s.jsxs)("div",{className:(0,T.cn)("shadow-lg rounded-lg flex flex-col items-center justify-between transition-all duration-200","relative overflow-hidden","bg-white text-black"),style:{width:b(33),height:b(22),padding:b(.5)},children:[(0,s.jsxs)("div",{className:"flex-1 flex flex-col justify-start items-center gap-[0.15rem] w-full",children:[(0,s.jsx)("div",{className:"w-full text-center font-bold tracking-wide text-black",style:{fontSize:"".concat(.6*u,"rem")},children:"ESTRELA METAIS"}),(0,s.jsx)("div",{className:"w-full text-center font-medium text-black",style:{fontSize:"".concat(.6*u,"rem")},children:e.name_short}),(0,s.jsx)("div",{className:"w-full text-center font-medium text-black",style:{fontSize:"".concat(.6*u,"rem")},children:e.product_code})]}),(0,s.jsx)("div",{className:"mt-auto w-full flex justify-center",children:j(e.barcode)})]},"".concat(r,"-").concat(t)))},r))})})}),(0,s.jsxs)("div",{className:"text-center text-sm text-muted-foreground space-y-1",children:[(0,s.jsxs)("p",{children:["Produtos diferentes: ",y," | ","Total de etiquetas: ",v]}),(0,s.jsx)("p",{children:"Dimens\xf5es de cada etiqueta: 33mm x 22mm"})]}),(0,s.jsx)(F.cN,{className:"mt-6",children:(0,s.jsxs)("div",{className:"flex w-full justify-between items-center",children:[(0,s.jsx)("div",{className:"text-sm text-muted-foreground"}),(0,s.jsx)(i.z,{onClick:w,disabled:p||!g||0===h.length,className:"min-w-[150px]",children:p?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(d,{className:"h-4 w-4 mr-2 animate-spin"}),"Imprimindo..."]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(f.Z,{className:"h-4 w-4 mr-2"}),"Imprimir Etiquetas"]})})]})})]})]})}let J=(0,c.Z)("CheckSquare",[["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}],["path",{d:"M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11",key:"1jnkn4"}]]);function U(){let{selectedPrinter:e,config:r}=(0,Y.G)(),[t,c]=(0,a.useState)(null),[g,h]=(0,a.useState)(!1),y=(0,a.useRef)(null),v=(0,a.useRef)({}),[b,j]=(0,a.useState)([]),[w,N]=(0,a.useState)([]),[k,S]=(0,a.useState)(""),[C,_]=(0,a.useState)({}),[E,z]=(0,a.useState)(!1),[R,q]=(0,a.useState)(!0),[I,A]=(0,a.useState)([]),[P,Z]=(0,a.useState)(new Map),[T,O]=(0,a.useState)(!1),{uniqueProductsCount:F,totalEtiquetas:H}={uniqueProductsCount:Object.keys(C).length,totalEtiquetas:Object.values(C).reduce((e,r)=>e+(""===r.quantity?0:Number(r.quantity)),0)},B=Object.keys(C).length>0,K=!!e,U=(0,a.useCallback)(async()=>{try{let e=await (0,n.dw)("get_products");j(e),Z(new Map(e.map(e=>[e.id,e])))}catch(e){console.error("Erro ao carregar produtos:",e),V.A.error("N\xe3o foi poss\xedvel carregar os produtos.",{description:String(e)})}},[]),$=(0,a.useCallback)(async()=>{try{let e=await (0,n.dw)("get_print_history");N(e)}catch(e){console.error("Erro ao carregar hist\xf3rico:",e)}},[]);(0,a.useEffect)(()=>{(async()=>{try{await Promise.all([U(),$()])}catch(e){console.error("Erro ao inicializar p\xe1gina:",e)}finally{q(!1)}})()},[U,$]);let Q=async()=>{if(!e){V.A.error("Erro",{description:"Configure a impressora antes de imprimir."});return}z(!0);try{let r=0,t=Object.values(C).reduce((e,r)=>{let t=""===r.quantity?0:Number(r.quantity);return e+t},0),s=[];for(let e in C){let r=C[e],t=""===r.quantity?1:Number(r.quantity);for(let e=0;e<t;e++)s.push(r)}for(let a=0;a<s.length;a+=3){let i=s.slice(a,a+3);for(;i.length<3;)i.push(null);await (0,n.dw)("print_label_batch",{products:i,printerName:e}),r+=i.filter(e=>null!==e).length,V.A.info("Imprimindo...",{description:"Etiqueta ".concat(r," de ").concat(t)}),await new Promise(e=>setTimeout(e,1e3))}V.A.success("Sucesso",{description:"".concat(r," etiqueta(s) impressa(s) com sucesso!")}),await $(),_({})}catch(e){console.error("Erro ao imprimir:",e),V.A.error("Erro de Impress\xe3o",{description:"Verifique se a impressora est\xe1 conectada e configurada corretamente."})}finally{z(!1)}},X=e=>{_(r=>{let t={...r};return t[e.id]?delete t[e.id]:t[e.id]={...e,quantity:1},t})},ee=(e,r)=>{let t=""===r?"":Number(r);_(r=>({...r,[e]:{...r[e],quantity:t}}))},er=(e,r)=>{if("Enter"===e.key){let e=C[r].quantity;(""===e||1>Number(e))&&ee(r,1),h(!1),c(null),y.current&&y.current.focus()}},et=[...b.filter(e=>g&&null!==t?e.id===t:e.product_code.toLowerCase().includes(k.toLowerCase()))].sort((e,r)=>{let t=!!C[e.id],s=!!C[r.id];return t&&!s?-1:!t&&s?1:0}),es=et.findIndex(e=>!C[e.id])-1;return R?(0,s.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,s.jsxs)("div",{className:"flex flex-col items-center gap-2",children:[(0,s.jsx)(d,{className:"h-8 w-8 animate-spin"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Carregando..."})]})}):(0,s.jsx)("div",{className:"container mx-auto p-4",children:(0,s.jsxs)("div",{className:"flex flex-col gap-6 max-w-full",children:[!K&&(0,s.jsxs)(M,{variant:"default",children:[(0,s.jsx)(u.Z,{className:"h-4 w-4"}),(0,s.jsxs)(L,{className:"flex items-center gap-2",children:["Impressora n\xe3o configurada.",(0,s.jsx)(i.z,{variant:"link",className:"px-2 py-0 h-auto",onClick:()=>window.location.href="/configuracao",children:"Configurar agora"})]})]}),(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsx)("h1",{className:"text-2xl font-bold",children:"Impress\xe3o das Etiquetas"}),B&&(0,s.jsxs)(W.C,{variant:"secondary",children:[F," produto",F>1?"s":""," selecionado",F>1?"s":"",", ",H," etiqueta",H>1?"s":""]})]}),(0,s.jsxs)("div",{className:"flex gap-2 w-full sm:w-auto",children:[B&&(0,s.jsx)(G,{products:(()=>{let e=[];for(let r in C){let t=C[r],s=""===t.quantity?1:Number(t.quantity);for(let r=0;r<s;r++)e.push(t)}return e})(),disabled:!1}),(0,s.jsx)(i.z,{onClick:Q,className:"transition-opacity duration-300",disabled:!B||E||!K,children:E?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(d,{className:"h-4 w-4 mr-2 animate-spin"}),"Imprimindo..."]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(f.Z,{className:"h-4 w-4 mr-2"}),"Imprimir Selecionados"]})})]})]}),(0,s.jsxs)("div",{className:"relative flex-1",children:[(0,s.jsx)(m.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-muted-foreground"}),(0,s.jsx)(x.I,{ref:y,placeholder:"Buscar por c\xf3digo do produto...",className:"pl-8 focus:ring-2 focus:ring-amber-400  focus-visible:ring-amber-400 focus-visible:ring-2",value:k,onChange:e=>S(e.target.value),onKeyDown:e=>{if("Enter"===e.key){let e=b.find(e=>e.product_code.toLowerCase()===k.toLowerCase());if(e){let r=e.id;C[r]||(X(e),ee(r,1)),c(r),S(""),h(!0),setTimeout(()=>{v.current[r]&&(v.current[r].focus(),v.current[r].select())},50)}else{let e=b.find(e=>e.product_code.toLowerCase().includes(k.toLowerCase()));if(e){let r=e.id;C[r]||(X(e),ee(r,1)),c(r),S(""),h(!0),setTimeout(()=>{v.current[r]&&(v.current[r].focus(),v.current[r].select())},50)}else V.A.error("Produto n\xe3o encontrado",{description:'Nenhum produto com o c\xf3digo "'.concat(k,'" foi encontrado.')})}}},autoFocus:!0})]}),(0,s.jsxs)(o.Zb,{children:[(0,s.jsx)(o.Ol,{children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)(o.ll,{children:"Produtos"}),B&&(0,s.jsxs)(i.z,{variant:"ghost",size:"sm",onClick:()=>_({}),className:"h-7 px-2 flex items-center gap-2 border border-input hover:border-accent rounded-md transition-colors",children:[(0,s.jsx)(J,{className:"h-4 w-4"}),"Desmarcar Todos"]})]})}),(0,s.jsx)(o.aY,{className:"max-h-[480px] overflow-y-auto",children:(0,s.jsxs)(l.iA,{children:[(0,s.jsx)(l.xD,{children:(0,s.jsxs)(l.SC,{children:[(0,s.jsx)(l.ss,{className:"w-[50px]"}),(0,s.jsx)(l.ss,{children:"C\xf3digo do Produto"}),(0,s.jsx)(l.ss,{children:"Codigo de Barras"}),(0,s.jsx)(l.ss,{children:"Nome"}),(0,s.jsx)(l.ss,{children:"Quantidade de Etiquetas"}),(0,s.jsx)(l.ss,{className:"text-right",children:"Selecionar"})]})}),(0,s.jsx)(l.RM,{children:0===et.length?(0,s.jsx)(l.SC,{children:(0,s.jsx)(l.pj,{colSpan:6,className:"text-center text-muted-foreground",children:"Nenhum produto encontrado"})}):et.map((e,r)=>(0,s.jsxs)(a.Fragment,{children:[(0,s.jsxs)(l.SC,{className:"\n                          ".concat(C[e.id]?"bg-primary/10 hover:bg-primary/15":"","\n                          table-row-enter table-row-enter-active table-row-move\n                        "),children:[(0,s.jsx)(l.pj,{children:(0,s.jsx)(D,{checked:!!C[e.id],onCheckedChange:()=>X(e)})}),(0,s.jsx)(l.pj,{children:e.product_code}),(0,s.jsx)(l.pj,{children:e.barcode}),(0,s.jsx)(l.pj,{children:e.name}),(0,s.jsx)(l.pj,{children:C[e.id]&&(0,s.jsx)(x.I,{type:"number",min:"0",value:C[e.id].quantity,onChange:r=>ee(e.id,r.target.value),className:"w-20 ".concat(t===e.id?"ring-2 ring-primary":""," focus:ring-2 focus:ring-amber-400  focus-visible:ring-amber-400"),ref:r=>{r&&(v.current[e.id]=r)},onKeyDown:r=>er(r,e.id)})}),(0,s.jsx)(l.pj,{className:"text-right",children:(0,s.jsx)(i.z,{variant:"outline",size:"icon",onClick:()=>{X(e),C[e.id]||ee(e.id,1)},children:(0,s.jsx)(p.Z,{className:"h-4 w-4"})})})]}),r===es&&es>=0&&(0,s.jsx)(l.SC,{children:(0,s.jsx)(l.pj,{colSpan:6,className:"p-0 h-[4px] bg-primary/50"})})]},e.id))})]})})]})]})})}},9174:function(e,r,t){"use strict";t.d(r,{C:function(){return o}});var s=t(7437);t(2265);var a=t(535),n=t(3448);let i=(0,a.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function o(e){let{className:r,variant:t,...a}=e;return(0,s.jsx)("div",{className:(0,n.cn)(i({variant:t}),r),...a})}},2381:function(e,r,t){"use strict";t.d(r,{d:function(){return l},z:function(){return c}});var s=t(7437),a=t(2265),n=t(7053),i=t(535),o=t(3448);let l=(0,i.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),c=a.forwardRef((e,r)=>{let{className:t,variant:a,size:i,asChild:c=!1,...d}=e,u=c?n.g7:"button";return(0,s.jsx)(u,{className:(0,o.cn)(l({variant:a,size:i,className:t})),ref:r,...d})});c.displayName="Button"},9820:function(e,r,t){"use strict";t.d(r,{Ol:function(){return o},SZ:function(){return c},Zb:function(){return i},aY:function(){return d},ll:function(){return l}});var s=t(7437),a=t(2265),n=t(3448);let i=a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,s.jsx)("div",{ref:r,className:(0,n.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",t),...a})});i.displayName="Card";let o=a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,s.jsx)("div",{ref:r,className:(0,n.cn)("flex flex-col space-y-1.5 p-6",t),...a})});o.displayName="CardHeader";let l=a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,s.jsx)("div",{ref:r,className:(0,n.cn)("text-2xl font-semibold leading-none tracking-tight",t),...a})});l.displayName="CardTitle";let c=a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,s.jsx)("div",{ref:r,className:(0,n.cn)("text-sm text-muted-foreground",t),...a})});c.displayName="CardDescription";let d=a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,s.jsx)("div",{ref:r,className:(0,n.cn)("p-6 pt-0",t),...a})});d.displayName="CardContent",a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,s.jsx)("div",{ref:r,className:(0,n.cn)("flex items-center p-6 pt-0",t),...a})}).displayName="CardFooter"},4291:function(e,r,t){"use strict";t.d(r,{$N:function(){return x},Be:function(){return g},Vq:function(){return l},cN:function(){return p},cZ:function(){return f},fK:function(){return m},hg:function(){return c}});var s=t(7437),a=t(2265),n=t(6100),i=t(2489),o=t(3448);let l=n.fC,c=n.xz,d=n.h_;n.x8;let u=a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,s.jsx)(n.aV,{ref:r,className:(0,o.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...a})});u.displayName=n.aV.displayName;let f=a.forwardRef((e,r)=>{let{className:t,children:a,...l}=e;return(0,s.jsxs)(d,{children:[(0,s.jsx)(u,{}),(0,s.jsxs)(n.VY,{ref:r,className:(0,o.cn)("fixed left-[50%] top-[50%] z-50 grid w-full translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg overflow-hidden",t),...l,children:[a,(0,s.jsxs)(n.x8,{className:"absolute right-4 top-2 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,s.jsx)(i.Z,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});f.displayName=n.VY.displayName;let m=e=>{let{className:r,...t}=e;return(0,s.jsx)("div",{className:(0,o.cn)("flex flex-col space-y-1.5 text-center sm:text-left",r),...t})};m.displayName="DialogHeader";let p=e=>{let{className:r,...t}=e;return(0,s.jsx)("div",{className:(0,o.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",r),...t})};p.displayName="DialogFooter";let x=a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,s.jsx)(n.Dx,{ref:r,className:(0,o.cn)("text-lg font-semibold leading-none tracking-tight",t),...a})});x.displayName=n.Dx.displayName;let g=a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,s.jsx)(n.dk,{ref:r,className:(0,o.cn)("text-sm text-muted-foreground",t),...a})});g.displayName=n.dk.displayName},279:function(e,r,t){"use strict";t.d(r,{I:function(){return i}});var s=t(7437),a=t(2265),n=t(3448);let i=a.forwardRef((e,r)=>{let{className:t,type:a,...i}=e;return(0,s.jsx)("input",{type:a,className:(0,n.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),ref:r,...i})});i.displayName="Input"},3804:function(e,r,t){"use strict";t.d(r,{RM:function(){return l},SC:function(){return c},iA:function(){return i},pj:function(){return u},ss:function(){return d},xD:function(){return o}});var s=t(7437),a=t(2265),n=t(3448);let i=a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,s.jsx)("div",{className:"relative w-full overflow-auto",children:(0,s.jsx)("table",{ref:r,className:(0,n.cn)("w-full caption-bottom text-sm",t),...a})})});i.displayName="Table";let o=a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,s.jsx)("thead",{ref:r,className:(0,n.cn)("[&_tr]:border-b",t),...a})});o.displayName="TableHeader";let l=a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,s.jsx)("tbody",{ref:r,className:(0,n.cn)("[&_tr:last-child]:border-0",t),...a})});l.displayName="TableBody",a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,s.jsx)("tfoot",{ref:r,className:(0,n.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",t),...a})}).displayName="TableFooter";let c=a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,s.jsx)("tr",{ref:r,className:(0,n.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",t),...a})});c.displayName="TableRow";let d=a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,s.jsx)("th",{ref:r,className:(0,n.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",t),...a})});d.displayName="TableHead";let u=a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,s.jsx)("td",{ref:r,className:(0,n.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",t),...a})});u.displayName="TableCell",a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,s.jsx)("caption",{ref:r,className:(0,n.cn)("mt-4 text-sm text-muted-foreground",t),...a})}).displayName="TableCaption"},4463:function(e,r,t){"use strict";t.d(r,{G:function(){return u},PrinterProvider:function(){return d}});var s=t(7437),a=t(2265),n=t(712),i=t(4438);let o=(0,a.createContext)(void 0),l=(e,r)=>{try{return localStorage.setItem(e,r),!0}catch(r){return console.error("Erro ao salvar ".concat(e," no localStorage:"),r),!1}},c=e=>{try{return localStorage.getItem(e)}catch(r){return console.error("Erro ao ler ".concat(e," do localStorage:"),r),null}};function d(e){let{children:r}=e,[t,d]=(0,a.useState)([]),[u,f]=(0,a.useState)(""),[m,p]=(0,a.useState)({darkness:8,width:840,height:176,speed:2,port:"Windows"}),[x,g]=(0,a.useState)(!1),[h,y]=(0,a.useState)(!1),v=(e,r)=>{d(e),r&&e.includes(r)?(console.log("Usando impressora salva:",r),f(r)):!u&&e.length>0&&(console.log("Selecionando primeira impressora dispon\xedvel:",e[0]),f(e[0])),l("cachedPrinters",JSON.stringify(e)),l("printersCacheTime",Date.now().toString())},b=async e=>{console.log("Definindo impressora selecionada:",e),f(e),l("selectedPrinter",e);try{let r={...m,port:"Windows",selected_printer:e};return console.log("Salvando configura\xe7\xe3o com impressora:",r),await (0,n.dw)("save_printer_settings",{config:r}),await (0,n.dw)("connect_printer",{config:r,printerName:e}),console.log("Impressora salva e conectada com sucesso:",e),!0}catch(e){return console.error("Erro ao salvar impressora nas configura\xe7\xf5es:",e),!1}},j=async function(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0];arguments.length>1&&void 0!==arguments[1]&&arguments[1];let r=c("cachedPrinters"),t=c("printersCacheTime"),s=t?Date.now()-Number.parseInt(t):Number.POSITIVE_INFINITY;if(r&&s<3e5)try{let t=JSON.parse(r);if(Array.isArray(t)&&t.length>0&&(v(t,m.selected_printer||c("selectedPrinter")),s<3e4&&!e))return}catch(e){console.error("Erro ao processar cache de impressoras:",e)}try{let r=await (0,n.dw)("list_printers",{silent:!0});v(r,m.selected_printer||c("selectedPrinter")),0===r.length?e&&i.A.error("Nenhuma impressora encontrada no Windows",{description:"Instale uma impressora no Windows para continuar."}):e&&i.A.success("Impressoras encontradas!",{description:"".concat(r.length," impressora(s) dispon\xedvel(is)")})}catch(r){console.error("Erro ao procurar impressoras:",r),e&&i.A.error("Erro ao procurar impressoras",{description:String(r)})}},w=async()=>{try{console.log("Carregando configura\xe7\xf5es salvas...");let e=await (0,n.dw)("get_printer_settings");if(e){if(console.log("Configura\xe7\xf5es carregadas:",e),p(e),e.selected_printer)console.log("Impressora salva encontrada nas configura\xe7\xf5es:",e.selected_printer),f(e.selected_printer),l("selectedPrinter",e.selected_printer);else{console.log("Nenhuma impressora salva nas configura\xe7\xf5es");let r=c("selectedPrinter");if(r){console.log("Impressora encontrada no localStorage:",r),f(r);let t={...e,selected_printer:r};p(t),await (0,n.dw)("save_printer_settings",{config:t}),console.log("Configura\xe7\xf5es atualizadas com impressora do localStorage")}}}else{console.log("Nenhuma configura\xe7\xe3o salva encontrada");let e=c("selectedPrinter");if(e){console.log("Impressora encontrada no localStorage:",e),f(e);let r={...m,selected_printer:e};p(r),await (0,n.dw)("save_printer_settings",{config:r}),console.log("Novas configura\xe7\xf5es criadas com impressora do localStorage")}}}catch(r){console.error("Erro ao carregar configura\xe7\xf5es:",r);let e=c("selectedPrinter");e&&(console.log("Usando impressora do localStorage ap\xf3s erro:",e),f(e))}},N=async()=>{if(!u){i.A.error("Nenhuma impressora selecionada",{description:"Selecione uma impressora primeiro"});return}g(!0);try{let e={...m,port:"Windows",selected_printer:u};console.log("Salvando configura\xe7\xf5es completas:",e),await (0,n.dw)("save_printer_settings",{config:e}),await (0,n.dw)("connect_printer",{config:e,printerName:u}),l("selectedPrinter",u),i.A.success("Configura\xe7\xf5es salvas!",{description:"Par\xe2metros de impress\xe3o atualizados."})}catch(e){console.error("Erro ao salvar configura\xe7\xf5es:",e),i.A.error("Erro ao salvar configura\xe7\xf5es",{description:String(e)})}finally{g(!1)}},k=async()=>{if(!u){i.A.error("Nenhuma impressora selecionada",{description:"Selecione uma impressora primeiro"});return}try{await (0,n.dw)("print_test",{printerName:u}),i.A.success("Teste enviado!",{description:"Verifique a impressora"})}catch(e){i.A.error("Erro ao imprimir teste",{description:String(e)})}},S=async()=>{try{return await (0,n.dw)("is_printer_connected")}catch(e){return console.error("Erro ao verificar conex\xe3o da impressora:",e),!1}};return(0,a.useEffect)(()=>{h||(async()=>{g(!0);try{await w(),await j(!1,!0)}catch(e){console.error("Erro na inicializa\xe7\xe3o:",e)}finally{g(!1),y(!0)}})()},[h]),(0,s.jsx)(o.Provider,{value:{printers:t,selectedPrinter:u,config:m,loading:x,searchPrinters:j,setSelectedPrinter:b,saveConfig:N,testPrint:k,updateConfig:e=>{p(r=>({...r,...e}))},isPrinterConnected:S},children:r})}function u(){let e=(0,a.useContext)(o);if(void 0===e)throw Error("usePrinter must be used within a PrinterProvider");return e}},3448:function(e,r,t){"use strict";t.d(r,{cn:function(){return n}});var s=t(1994),a=t(3335);function n(){for(var e=arguments.length,r=Array(e),t=0;t<e;t++)r[t]=arguments[t];return(0,a.m6)((0,s.W)(r))}},6718:function(e,r,t){"use strict";t.d(r,{D:function(){return a}});var s=t(2265);function a(e){let r=s.useRef({value:e,previous:e});return s.useMemo(()=>(r.current.value!==e&&(r.current.previous=r.current.value,r.current.value=e),r.current.previous),[e])}},420:function(e,r,t){"use strict";t.d(r,{t:function(){return n}});var s=t(2265),a=t(1188);function n(e){let[r,t]=s.useState(void 0);return(0,a.b)(()=>{if(e){t({width:e.offsetWidth,height:e.offsetHeight});let r=new ResizeObserver(r=>{let s,a;if(!Array.isArray(r)||!r.length)return;let n=r[0];if("borderBoxSize"in n){let e=n.borderBoxSize,r=Array.isArray(e)?e[0]:e;s=r.inlineSize,a=r.blockSize}else s=e.offsetWidth,a=e.offsetHeight;t({width:s,height:a})});return r.observe(e,{box:"border-box"}),()=>r.unobserve(e)}t(void 0)},[e]),r}}},function(e){e.O(0,[583,598,515,359,971,117,744],function(){return e(e.s=6070)}),_N_E=e.O()}]);